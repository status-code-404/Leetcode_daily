use std::cell::RefCell;
use std::collections::HashMap;
use lazy_static::lazy_static;
use std::sync::Mutex;
use crate::answer;


// 同超时，能跑过80%用例， 求个大佬指正
lazy_static! {
        static ref Hashmap: Mutex<RefCell<HashMap<[i32;3],i32>>> = Mutex::new(RefCell::new(HashMap::new()));
}

pub mod answer_1626{
    use std::cmp::max;
    use std::iter::zip;
    use crate::answer_1626::Hashmap;

    pub fn dfs(mut people: Vec<[i32; 2]>, score_limit:i32) ->i32{
        if people.len() == 0{
           return 0;
        }

        let index = [people[0][0], people[0][1], score_limit];
        let mut hash = Hashmap.lock().unwrap();
        return match hash.get_mut().get(&index) {
            Some(score) => { score.clone() },
            _ => {
                let this_score = index[1];
                people.remove(0);
                let mut max_ = 0;
                if this_score < score_limit {
                    drop(hash);
                    max_ = dfs(people, score_limit);
                } else {
                    drop(hash);
                    max_ = max(dfs(people.clone(), this_score) + this_score, dfs(people, score_limit));
                }
                let mut hash = Hashmap.lock().unwrap();
                hash.get_mut().insert(index, max_.clone());
                max_
            }
        };
    }

    pub fn answer(scores: Vec<i32>, ages: Vec<i32>) -> i32 {
        let mut hash = Hashmap.lock().unwrap();
        hash.get_mut().clear();
        drop(hash);
        let mut m = Vec::new();
        for i in zip(ages, scores){
            m.push([i.0, i.1])
        }
        m.sort();
        return dfs(m, -1)
    }
}

#[test]
fn test2(){
    assert_eq!(answer(vec![1,2,3,5], vec![8,9,10,1]), 6 , "Wrong");
    assert_eq!(answer(vec![10791,106667,632432,560006,685813,85610,878743,435738,832154,577793,972524,113981,40151,790711,273848,715211,191752,562804,648779,736892,565722,227007,699960,620852,440927,586469,392807,416607,154493,209332,377468,14291,218165,780202,973545,325616,845242,451747,147852,194030,10526,454512,249929,353881,224924,607754,736310,813387,845208,248217,177862,699494,444429,177253,896016,321971,615598,380652,445899,696188,289866,205957,513651,122409,969562,535874,640822,530110,870092,433810,612126,312324,323090,826215,710015,672973,15541,916403,903108,685252,680807,236173,672219,58460,326390,511502,513340,889007,355554,966510,773380,865819,542718,683777,469364,339460,382784,996005,323882,101865,527625,679596,793250,898796,282708,49903,541116,101423,612189,272284,684071,828898,131240,939803,872848,647842,734825,718967,644999,379460,672757,243793,366883,482998,799664,481403,181117,655439,953225,200439,125288,899684,487073,293010,194169,301149,481520,112622,153899,929736,613933,46659,176837,93069,455188,124777,487982,561047,866901,432663,840043,633313,528638,864792,105003,927475,550073,279832,261865,914197,229101,616597,806075,507714,725578,922488,486015,342332,842192,417434,887729,344852,737216,925258,476135,253846,642770,212440,589412,869125,53235,338106,613390,989758,147792,249433,395208,249832,172502,146619,805684,24785,73974,343255,628075,100109,815333,286027,119460,573773,164225,868302,304827,75772,137306,931645,979531,775881,659408,11697,901093,977339,560375,298314,775822,204171,802672,741403,42828,345977,785727,900614,769083,652864,279493,37121,628283,191044,808729,932308,765546,103089,959012,289491,493880,918977,292139,648114,344869,139149,148234,492085,782196,338667,253180,205380,758360,397529,146122,674685,90917,327315,245809,301,967567,454964,758778,317509,958355,643432,698865,337236,485483,193889,741754,173337,355300,304801,546213,611071,469589,882233,925965,598300,371459,140844,816937,318915,725578,767437,441821,615670,73913,809300,243970,908611,926693,549781,260475,982977,764727,146549,365248,924774,238782,980085,807365,604095,545833,754723,116320,890711,970081,739106,409614,233016,51278,834467,124046,633302,494699,393396,185891,237287,11010,754225,952966,993813,640312,555431,984936,526237,737629,473800,926411,980066,132549,811650,854488,565142,20877,888943,756604,5960,554284,462016,713726,678183,243955,352401,9272,69536,292151,591726,885871,934878,32856,167718,825199,921200,753132,330429,357172,458265,953547,996677,553091,96811,322392,542095,586595,395831,862856,549130,691930,393033,997382,536298,703484,950599,916937,853508,329537,659311,574848,568506,266356,487254,502852,305200,601913,713507,616814,262685,386874,708056,471620,821058,321846,323072,853774,10313,785173,30605,959845,77373,37140,546896,766827,722358,460461,793429,275617,910831,958467,253929,34894,423303,266621,260686,466526,942520,7520,265215,53963,625759,253170,736250,300757,425462,999545,653329,400862,777436,347042,421808,301611,757265,170117,82709,925602,172851,45985,973394,389401,421470,674368,476343,895551,388040,32805,694073,711208,675207,42033,605465,772773,793700,58646,215866,393574,381670,544480,240265,494603,443105,981153,642048,869704,53407,193249,117880,281921,531950,589584,325980,802329,422809,422731,572054,693412,431726,800697,320483,794032,289688,285483,231126,931228,202158,343737,960199,77118,845481,608268,469881,256493,569051,315978,531131,64612,598444,552025,752773,181697,846943,443200,395029,427255,967643,138485,1316,118346,381078,976182,282956,219552,389492,532889,630445,97449,162712,579311,142291,393827,785193,803345,572347,340394,375063,215381,483644,600605,195729,422269,354586,63187,799718,602763,480984,160734,107598,410016,931724,167901,474574,385714,3717,618454,931713,246406,24329,171706,36392,853383,659280,621949,868450,509169,347212,850127,182162,757710,781920,782166,217637,19442,257327,752769,912649,544855,837211,812565,270496,790271,556220,282473,78784,646141,356050,666472,813133,212596,661047,553565,272201,988472,428798,179441,941495,191751,477124,58755,300917,412641,519636,409680,775472,342068,238445,939422,252656,70347,694463,721407,142471,858898,996953,797241,77604,832713,133074,178065,187439,243938,7366,106923,327515,931058,883212,721813,207746,198111,693802,973930,627986,55371,446980,789246,652885,965632,620482,138734,532180,550418,916155,237316,486360,625619,253417,818968,635131,721189,911623,168933,466111,891542,643737,257097,713439,313894,315499,860500,971635,564236,531617,497328,472291,581284,504535,650714,672852,390108,167388,621056,182664,185869,174242,472193,154960,758878,712979,238013,608426,479702,823810,252264,609323,109930,979341,898270,29671,538701,669680,836315,825673,331621,957667,14969,388967,204994,359186,71913,270957,314020,805744,766879,57819,235325,337086,954073,637250,990447,911522,34405,688120,204060,510563,422122,903502,388603,479860,678637,554836,440137,230775,547946,541207,848954,758015,521133,379945,394113,622561,537810,275649,585813,570391,723081,535524,33157,441195,966862,808052,701358,914214,679599,744745,341294,392185,893850,657533,466092,981422,636315,601122,423646,554665,208795,450677,363361,737296,127237,191973,787247,597857,87974,162851,470364,971934,262444,370607,88033,279941,649067,149158,982182,485726,618542,998630,565216,850288,979966,709207,383048,142814,497837,336445,968793,875036,839454,413069,64014,936705,818141,417961,317195,197213,648846,806865,384229,492997,358697,633565,52294,713619,818915,530533,230306,790451,875932,264531,851458,155879,775138,88007,978978,812288,414353,791396,342345,407830,335095,650948,666584,881946,614766,283157,368188,764945,555781,159176,967365,151769,824059,43200,93109,293607,394430,696205,266590,169871,662121,320698,14993,437745,786139,916951,981521,513627,480052,622909,916166,162960,95282,11837,996142,373421,83683,706760,231109,481474,957893,15386,286973,343214,412048,435264,437987,972200,905311,915830,364212,960141,146426,194258,233764,141397,296480,15361,370854,621039,161499,915600,720811,781731,435790,792231,755154,960654,183749,760845,691004,521171,627057,272429,221242,814571,686221,296031,250073,282418,414538,232748,448670,983632,592036,251054,599101,148787,837850,184142,106996,872453,653410,350936,275448,278878,919189,640460,114185,349551,421084,550794,4636,978024,33109,985472,933607,333404,778022,873001,588643,60907,427987,433382,880496,341212,948422,269965,628312,103531,857811,495707,118426,741424,274221,640229,357149,721936,912076,354421,965674,475217,637623,953827], vec![294,174,292,230,204,577,833,417,548,411,400,313,942,675,984,627,314,6,351,954,148,682,897,132,848,825,186,571,990,91,778,415,540,762,771,197,528,367,56,399,973,264,747,902,901,620,523,855,653,437,272,699,186,652,63,181,105,587,888,674,513,673,538,697,378,476,931,101,225,422,256,575,349,397,915,459,413,785,896,453,518,827,8,513,482,412,916,244,594,685,29,884,266,470,747,209,238,194,242,561,821,895,902,555,551,213,697,12,951,278,378,225,250,670,815,359,697,218,372,733,72,950,240,456,570,838,648,719,498,982,169,639,794,775,834,823,22,514,693,864,693,176,98,344,355,972,917,153,393,496,626,594,121,380,177,898,172,895,684,975,974,46,99,346,148,166,179,191,184,854,416,599,67,585,535,585,489,214,664,976,360,547,629,373,948,762,426,442,635,223,1000,393,464,896,137,738,47,610,472,109,224,141,695,367,292,455,807,901,780,776,889,78,495,363,827,357,242,441,895,645,814,812,438,893,791,65,340,111,476,481,833,569,430,356,496,839,82,680,6,929,498,875,244,78,661,36,578,58,404,473,985,409,837,45,934,846,397,574,940,738,256,315,976,253,284,937,929,9,584,328,934,519,154,161,759,472,818,388,40,538,304,463,8,736,655,368,154,257,342,861,461,434,747,7,565,885,309,99,302,827,509,70,579,759,96,329,206,791,952,278,980,264,363,105,376,732,929,765,615,435,162,647,731,98,508,438,936,923,46,94,801,275,320,616,953,725,847,840,202,114,264,349,223,226,361,900,753,824,375,543,163,744,257,238,665,191,461,281,957,813,977,100,989,860,436,633,221,907,632,935,218,949,633,22,628,759,739,34,479,355,355,242,916,851,146,499,393,876,569,953,877,705,257,436,919,970,695,380,584,815,729,411,841,453,117,991,11,660,323,861,502,534,796,351,645,558,82,588,660,227,41,253,439,529,196,878,361,8,786,757,143,79,438,111,171,658,516,226,71,530,661,726,172,37,353,553,306,695,604,494,275,123,478,144,499,610,839,102,670,981,957,282,487,84,12,275,841,786,436,197,356,724,631,45,958,678,86,656,482,517,439,105,559,841,943,745,512,33,525,485,631,110,401,505,662,89,369,616,271,81,953,462,2,466,813,265,528,623,647,638,481,698,107,81,346,203,899,619,33,412,607,537,125,652,300,675,52,72,925,40,515,779,918,583,274,724,991,93,706,356,428,614,347,248,840,133,161,386,885,977,571,900,822,147,382,731,207,617,136,431,305,939,3,902,396,885,497,927,990,863,540,497,214,481,697,629,964,10,225,146,252,684,527,569,569,121,706,68,682,953,555,845,160,730,355,403,644,67,130,540,442,167,278,514,651,425,943,86,531,471,808,542,787,697,711,861,841,229,648,369,561,826,127,595,165,191,773,355,350,180,575,131,8,917,493,732,758,598,643,332,124,130,715,9,717,413,331,301,283,469,855,364,799,609,218,827,644,597,921,403,538,436,970,657,243,51,13,985,912,260,728,786,291,153,609,229,436,754,57,74,419,749,991,948,377,93,911,691,266,1,636,930,55,492,32,695,698,12,451,953,433,144,21,192,822,469,363,396,472,570,444,528,760,41,65,798,28,784,16,389,590,190,296,604,514,50,115,338,105,346,766,871,946,923,663,657,177,767,586,827,938,985,76,570,185,812,221,3,718,442,407,109,907,899,842,329,232,317,602,781,202,328,887,91,439,607,570,968,772,711,217,595,618,532,4,763,133,96,781,598,799,11,525,584,858,668,520,866,720,520,251,681,716,988,825,305,819,99,958,744,303,54,253,287,54,725,979,934,972,82,131,484,75,333,531,400,219,470,919,16,433,494,718,884,284,997,978,190,156,650,723,121,447,177,112,439,55,880,934,706,625,149,965,918,971,804,503,387,267,72,676,286,337,391,276,6,282,720,206,698,971,406,869,802,529,675,838,458,363,87,606,421,544,438,644,913,96,870,473,56,271,3,974,55,367,496,116,863,19,789,534,25,250,437,69,10,376,537,177,761,888,366,7,65,259,536,396,934,700,521,512,448,684,880,86,344,849,276,110,340,325,162,874,519,996,726,285,942,156,520,344,11,710,340,106,824]), 34501833, "wrong")
}